package lib

import (
	_ "unsafe"
)

const digits = "0123456789"
const smallsString = "00010203040506070809" +
	"10111213141516171819" +
	"20212223242526272829" +
	"30313233343536373839" +
	"40414243444546474849" +
	"50515253545556575859" +
	"60616263646566676869" +
	"70717273747576777879" +
	"80818283848586878889" +
	"90919293949596979899"
const smallsString2 = "000001002003004005006007008009" +
	"010011012013014015016017018019" +
	"020021022023024025026027028029" +
	"030031032033034035036037038039" +
	"040041042043044045046047048049" +
	"050051052053054055056057058059" +
	"060061062063064065066067068069" +
	"070071072073074075076077078079" +
	"080081082083084085086087088089" +
	"090091092093094095096097098099" +
	"100101102103104105106107108109" +
	"110111112113114115116117118119" +
	"120121122123124125126127128129" +
	"130131132133134135136137138139" +
	"140141142143144145146147148149" +
	"150151152153154155156157158159" +
	"160161162163164165166167168169" +
	"170171172173174175176177178179" +
	"180181182183184185186187188189" +
	"190191192193194195196197198199" +
	"200201202203204205206207208209" +
	"210211212213214215216217218219" +
	"220221222223224225226227228229" +
	"230231232233234235236237238239" +
	"240241242243244245246247248249" +
	"250251252253254255256257258259" +
	"260261262263264265266267268269" +
	"270271272273274275276277278279" +
	"280281282283284285286287288289" +
	"290291292293294295296297298299" +
	"300301302303304305306307308309" +
	"310311312313314315316317318319" +
	"320321322323324325326327328329" +
	"330331332333334335336337338339" +
	"340341342343344345346347348349" +
	"350351352353354355356357358359" +
	"360361362363364365366367368369" +
	"370371372373374375376377378379" +
	"380381382383384385386387388389" +
	"390391392393394395396397398399" +
	"400401402403404405406407408409" +
	"410411412413414415416417418419" +
	"420421422423424425426427428429" +
	"430431432433434435436437438439" +
	"440441442443444445446447448449" +
	"450451452453454455456457458459" +
	"460461462463464465466467468469" +
	"470471472473474475476477478479" +
	"480481482483484485486487488489" +
	"490491492493494495496497498499" +
	"500501502503504505506507508509" +
	"510511512513514515516517518519" +
	"520521522523524525526527528529" +
	"530531532533534535536537538539" +
	"540541542543544545546547548549" +
	"550551552553554555556557558559" +
	"560561562563564565566567568569" +
	"570571572573574575576577578579" +
	"580581582583584585586587588589" +
	"590591592593594595596597598599" +
	"600601602603604605606607608609" +
	"610611612613614615616617618619" +
	"620621622623624625626627628629" +
	"630631632633634635636637638639" +
	"640641642643644645646647648649" +
	"650651652653654655656657658659" +
	"660661662663664665666667668669" +
	"670671672673674675676677678679" +
	"680681682683684685686687688689" +
	"690691692693694695696697698699" +
	"700701702703704705706707708709" +
	"710711712713714715716717718719" +
	"720721722723724725726727728729" +
	"730731732733734735736737738739" +
	"740741742743744745746747748749" +
	"750751752753754755756757758759" +
	"760761762763764765766767768769" +
	"770771772773774775776777778779" +
	"780781782783784785786787788789" +
	"790791792793794795796797798799" +
	"800801802803804805806807808809" +
	"810811812813814815816817818819" +
	"820821822823824825826827828829" +
	"830831832833834835836837838839" +
	"840841842843844845846847848849" +
	"850851852853854855856857858859" +
	"860861862863864865866867868869" +
	"870871872873874875876877878879" +
	"880881882883884885886887888889" +
	"890891892893894895896897898899" +
	"900901902903904905906907908909" +
	"910911912913914915916917918919" +
	"920921922923924925926927928929" +
	"930931932933934935936937938939" +
	"940941942943944945946947948949" +
	"950951952953954955956957958959" +
	"960961962963964965966967968969" +
	"970971972973974975976977978979" +
	"980981982983984985986987988989" +
	"990991992993994995996997998999"

const nSmalls = 1000

//go:nosplit
func appendSmall(dest []byte, i int64) []byte {
	if i < 10 {
		return append(dest, digits[i : i+1]...)
	}
	if i < 100 {
		return append(dest, smallsString[i*2 : i*2+2]...)
	}
	return append(dest, smallsString2[i*3 : i*3+3]...)
}

//go:nosplit
func appendSmallU(dest []byte, i uint64) []byte {
	if i < 10 {
		return append(dest, digits[i : i+1]...)
	}
	if i < 100 {
		return append(dest, smallsString[i*2 : i*2+2]...)
	}
	return append(dest, smallsString2[i*3 : i*3+3]...)
}

//go:nosplit
func AppendInt(dest []byte, src int) []byte {
	return AppendInt64(dest, int64(src))
}

//go:nosplit
func AppendInt8(dest []byte, src int8) []byte {
	return AppendInt64(dest, int64(src))
}

//go:nosplit
func AppendInt16(dest []byte, src int16) []byte {
	return AppendInt64(dest, int64(src))
}

//go:nosplit
func AppendInt32(dest []byte, src int32) []byte {
	return AppendInt64(dest, int64(src))
}

//go:nosplit
func AppendInt64(dest []byte, src int64) []byte {
	if 0 <= src && src < nSmalls {
		return appendSmall(dest, src)
	}
	return formatBits(dest, uint64(src), src < 0)
}

//go:nosplit
func AppendUint(dest []byte, src uint) []byte {
	return AppendUint64(dest, uint64(src))
}

//go:nosplit
func AppendUint8(dest []byte, src uint8) []byte {
	return AppendUint64(dest, uint64(src))
}

//go:nosplit
func AppendUint16(dest []byte, src uint16) []byte {
	return AppendUint64(dest, uint64(src))
}

//go:nosplit
func AppendUint32(dest []byte, src uint32) []byte {
	return AppendUint64(dest, uint64(src))
}

//go:nosplit
func AppendUint64(dest []byte, src uint64) []byte {
	if src < nSmalls {
		return appendSmallU(dest, src)
	}
	return formatBits(dest, src, true)
}

//go:nosplit
func formatBits(dst []byte, u uint64, neg bool) []byte {
	d, _ := strconv_formatBits(dst, u, 10, neg, true)
	return d
}

//go:linkname strconv_formatBits strconv.formatBits
func strconv_formatBits(dst []byte, u uint64, base int, neg, append_ bool) (d []byte, s string)
